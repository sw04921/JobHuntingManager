{% extends "index.html" %}

{% block title %}ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸{% endblock %}

{% block header %}
<div class="app-title">
    <h1>å°±æ´»ç®¡ç†</h1>
</div>
<nav>
    <!-- ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ -->
    <a href="#company_table" class="header-link">ä¸€è¦§</a>
    <a href="#regist_new_company" class="header-link">ä¼šç¤¾æ–°è¦ç™»éŒ²</a>
    <span style="margin: 0 10px; color: #ccc;">|</span>
    <a href="{{ url_for('settings') }}" class="header-link" style="color: #555;">
        ğŸ‘¤ {{ current_user.username }}
    </a>
</nav>
{% endblock %}

{% block content %}

<div class="content-box" id="company_table">
    <div class="list-header">
        <h3>ç™»éŒ²æ¸ˆã¿ã®ä¼šç¤¾ä¸€è¦§</h3>
        <div class="sort-buttons">
            <span style="font-size: 12px; color: #666; margin-right: 5px;">ä¸¦ã³æ›¿ãˆ:</span>
            <a href="{{ url_for('index', industry=request.args.get('industry')) }}" class="btn-sort">ç™»éŒ²é †</a>
            <a href="{{ url_for('index', sort='interest', industry=request.args.get('industry')) }}"
                class="btn-sort">å¿—æœ›åº¦é †</a>
            <a href="{{ url_for('index', sort='deadline', deadline=request.args.get('deadline')) }}"
                class="btn-sort">æœŸé™é †</a>
        </div>
    </div>
    <div class="toolbar-container">
        <div class="filter-box">
            <form action="{{ url_for('index') }}" method="GET" class="filter-form">
                <span class="filter-label">æ¥­ç•Œã§çµã‚Šè¾¼ã¿:</span>
                <!-- ä¸¦ã³æ›¿ãˆã¨çµã‚Šè¾¼ã¿ã‚’åŒæ™‚ã«ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ -->
                <input type="hidden" name="sort" value="{{ request.args.get('sort', '') }}">
                <select name="industry" onchange="this.form.submit()" class="select-industry">
                    <!-- ãƒšãƒ¼ã‚¸æ›´æ–°å¾Œã‚‚é¸æŠã•ã‚ŒãŸçŠ¶æ…‹ã«ã™ã‚‹ -->
                    <option value="" {% if not request.args.get('industry') %}selected{% endif %}>ã™ã¹ã¦è¡¨ç¤º</option>
                    {% for industry in industries %}
                    <option value="{{ industry }}" {% if request.args.get('industry')==industry %}selected{% endif %}>
                        {{ industry }}
                    </option>
                    {% endfor %}
                </select>
            </form>
        </div>

        <button type="submit" form="delete-form" class="btn-delete-action">
            ãƒã‚§ãƒƒã‚¯ã—ãŸé …ç›®ã‚’å‰Šé™¤
        </button>

    </div>

    <!-------------------------------->
    <!--           ä¸€è¦§è¡¨           -->
    <!-------------------------------->
    <form id="delete-form" action="{{ url_for('delete_company', delete_targets=delete_targets) }}" method="POST"
        onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
        <table class="company-table">
            <thead>
                <tr>
                    <th></th>
                    <th>ä¼šç¤¾å</th>
                    <th style="text-align: center;">æ¥­ç•Œ</th>
                    <th>å¿—æœ›åº¦</th>
                    <th style="text-align: center;">é¸è€ƒçŠ¶æ³</th>
                    <th style="text-align: center;">æœŸé™</th>
                </tr>
            </thead>
            <tbody>
                {% for company in companies %}
                <tr class="
                {% if company.selection.status == 'å†…ã€…å®š' %}
                    row-gold
                {% elif company.selection.status == 'è¾é€€' or company.selection.status == 'ãŠç¥ˆã‚Š' %}
                    row-gray
                {% endif %}
                ">
                    <!-- å‰Šé™¤é¸æŠ -->
                    <td style="text-align: center;">
                        <input type="checkbox" name="delete_targets" value="{{ company.id }}">
                    </td>
                    <!-- ä¼šç¤¾å -->
                    <td>
                        <a href="{{ url_for('show_detail', id=company.id) }}" class="top_list_companyName">
                            {{ company.name }}
                        </a>
                    </td>
                    <!-- æ¥­ç•Œ -->
                    <td style="text-align: center;">
                        <span>{{ company.industry }}</span>
                    </td>
                    <!-- å¿—æœ›åº¦ -->
                    <td>
                        {% if company.interest %}
                        <span class="interest-badge">â˜… {{ company.interest }}</span>
                        {% else %}
                        <span style="color: #ccc; font-size: 12px;">-</span>
                        {% endif %}
                    </td>
                    <!-- é¸è€ƒçŠ¶æ³ -->
                    <td style="text-align: center;">
                        <span>{{ company.selection.status }}</span>
                    </td>
                    <!-- æœŸé™ -->
                    <td style="text-align: center;">
                        {% if company.interest %}
                        <span>{{ company.next_deadline }}</span>
                        {% else %}
                        <span style="color: #ccc; font-size: 12px;">-</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </form>

    {% if not companies %}
    <p style="text-align: center; color: #777; margin-top: 20px;">
        ã¾ã ç™»éŒ²ã•ã‚ŒãŸä¼šç¤¾ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
        å³ä¸Šã®ã€Œä¼šç¤¾æ–°è¦ç™»éŒ²ã€ã‹ã‚‰è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
    </p>
    {% endif %}
</div>

<div class="content-box" id="regist_new_company">
    <div class="info-header">
        <h3>ä¼šç¤¾æƒ…å ±ã®ç™»éŒ²</h3>
    </div>
    {% from "_formhelpers.html" import render_field %}
    <form method="POST" novalidate>
        {{ regist_form.csrf_token }}
        <span>{{ render_field(regist_form.name) }}</span>
        <span>{{ render_field(regist_form.industry) }}</span>
        <span>{{ render_field(regist_form.url) }}</span>
        {{ regist_form.submit(class="btn btn-register") }}
    </form>
</div>

{% endblock %}

{% block footer %}{% endblock %}